# Compiler for generic inline assembly code-generation

This folder holds alternative implementations of primitives
that uses inline assembly.

This avoids the pitfalls of traditional compiler bad code generation
for multiprecision arithmetic (see GCC https://gcc.godbolt.org/z/2h768y)
or unsupported features like handling 2 carry chains for
multiplication using MULX/ADOX/ADCX.

To be generic over multiple curves,
for example BN254 requires 4 words and BLS12-381 requires 6 words of size 64 bits,
the compilers is implemented as a set of macros that generate inline assembly.

⚠⚠⚠ Warning! Warning! Warning!

This is a significant sacrifice of code readability, portability, auditability and maintainability in favor of performance.

This combines 2 of the most notorious ways to obfuscate your code:
* metaprogramming and macros
* inline assembly

Adventurers beware: not for the faint of heart.

This is unfinished, untested, unused, unfuzzed and just a proof-of-concept at the moment.*

_* I take no responsibility if this smashes your stack, eats your cat, hides a skeleton in your closet, warps a pink elephant in the room, summons untold eldritch horrors or causes the heat death of the universe. You have been warned._

_The road to debugging hell is paved with metaprogrammed assembly optimizations._

_For my defence, OpenSSL assembly is generated by a Perl script and neither Perl nor the generated Assembly are type-checked by a dependently-typed compiler._

## References

Multiprecision (Montgomery) Multiplication & Squaring in Assembly

- Intel MULX/ADCX/ADOX Table 2 p13: https://www.intel.cn/content/dam/www/public/us/en/documents/white-papers/ia-large-integer-arithmetic-paper.pdf
- Squaring: https://www.intel.com/content/dam/www/public/us/en/documents/white-papers/large-integer-squaring-ia-paper.pdf
- https://eprint.iacr.org/eprint-bin/getfile.pl?entry=2017/558&version=20170608:200345&file=558.pdf
- https://github.com/intel/ipp-crypto
- https://github.com/herumi/mcl

Experimentations in Nim

- https://github.com/mratsim/finite-fields
